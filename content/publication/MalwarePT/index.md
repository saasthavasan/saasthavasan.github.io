---
authors:
  - admin
  - Yuzhou Nie
  - Kaie Chen
  - Yigitcan Kaya
  - Hojjat Aghakhani 
  - Wenbo Guo
  - Christopher Kruegel
  - Giovanni Vigna

title: 'MalwarePT: A Robust Binary-Level Foundation Model for Malware Analysis'

# Authors
# If you created a profile for a user (e.g. the default `admin` user), write the username (folder name) here
# and it will be replaced with their full name and linked to their profile.


# Author notes (optional)
# author_notes:
#   - 'Equal contribution'
#   - 'Equal contribution'

date: '2025-12-14T00:00:00Z'
# doi: ''

# Schedule page publish date (NOT publication's date).
# publishDate: '2017-01-01T00:00:00Z'

# Publication type.
# Accepts a single type but formatted as a YAML list (for Hugo requirements).
# Enter a publication type from the CSL standard.
publication_types: ['paper-conference']

# Publication name and optional abbreviated publication name.
# publication: The 40th Annual Computer Security Applications Conference
# publication_short: In ACSAC 2024

# Summary. An optional shortened abstract.
summary: In our paper, "MalwarePT: A Robust Binary-Level Foundation Model for Malware Analysis," we introduce MalwarePT, a novel foundation model designed to enhance malware analysis by addressing key limitations of existing machine learning (ML) approaches. Traditional ML methods for malware detection and classification often rely heavily on handcrafted feature engineering and supervised learning techniques. These dependencies hinder their generalizability across diverse malware types and render them vulnerable to adversarial attacks. To overcome these challenges, we developed MalwarePT, a binary-level foundation model that operates directly on the raw bytes of the code segments extracted from Windows Portable Executable (PE) malware binaries.

Our approach begins with the extraction of code segments from Windows PE malware binaries, focusing exclusively on the executable code to minimize the risk of adversarial manipulation without altering the malware's functionality. By using raw binary code as input, we aim to capture the intrinsic purpose and behavior of malware programs more effectively. Recognizing that code segments are harder to manipulate without breaking malware functionality, we leverage a BERT-based architecture for MalwarePT. This architecture is pretrained using self-supervised Masked Language Modeling (MLM) on a substantial corpus of unlabeled malware binaries. The MLM objective allows MalwarePT to learn intricate byte-level patterns and dependencies inherent in malicious code, facilitating the generation of rich representations that are both generalizable and robust against adversarial perturbations.

After the pretraining phase, we fine-tune MalwarePT with task-specific classification heads tailored for downstream tasks such as functionality classification and malware detection. For functionality classification, MalwarePT-FC, our fine-tuned model, demonstrates superior performance by accurately identifying malware functionalities even in imbalanced datasets. This capability is crucial for understanding the diverse behaviors of malware, which is often challenging for existing ML-based tools. In malware detection, MalwarePT-MD matches the performance of leading ML-based detectors while exhibiting enhanced robustness against various adversarial attacks, including those specifically designed to target raw byte-based models like Malconv2.

Our extensive evaluations utilize a comprehensive dataset of 155,238 unpacked Windows executable files, curated from sources such as VirusTotal, Packware, and a proprietary security vendor dataset. Through rigorous testing, MalwarePT not only outperforms state-of-the-art models in functionality classification but also maintains high detection accuracy in malware detection tasks. Importantly, MalwarePT exhibits resilience against temporal shifts and packing techniques, which are common methods used by malware authors to evade detection.

Additionally, we conducted a detailed analysis of model misclassifications, revealing that many errors stem from noisy and missing labels rather than inherent flaws in MalwarePT. This finding underscores the limitations of signature-based approaches and highlights MalwarePT’s ability to generalize effectively despite imperfect labeling. Our adversarial attack experiments further validate MalwarePT's robustness, demonstrating its superiority over existing models in resisting both black-box and code-based adversarial modifications.

In the security discussion, we acknowledge potential evasion strategies against MalwarePT, such as manipulating entry points or employing sophisticated packing methods. To address these vulnerabilities, we propose solutions like dynamic analysis and extending context lengths, which will be explored in future work. Our ablation studies confirm the effectiveness of MalwarePT’s multi-head attention mechanism, outperforming alternative neural network architectures like CNNs and GRUs in malware detection tasks.

In conclusion, MalwarePT represents a significant advancement in malware analysis by combining the strengths of foundation models with a focus on adversarial robustness and generalizability. By operating directly on raw code segments and minimizing reliance on handcrafted features, MalwarePT offers a more resilient and adaptable solution for malware detection and classification, paving the way for future research and development in this critical area of cybersecurity.

abstract: Traditional machine learning approaches for malware detection and classification often rely on handcrafted features and supervised learning, limiting their generalizability and vulnerability to adversarial attacks. This paper presents MalwarePT, a binary-level foundation model specifically designed for robust malware analysis. MalwarePT extracts raw bytes from the code segments of Windows PE malware binaries and employs a BERT-based architecture trained through self-supervised Masked Language Modeling on a large corpus of unlabeled malware samples. This pretraining enables the model to learn intricate byte-level patterns and dependencies inherent in malicious code. Subsequently, MalwarePT is fine-tuned with specialized classification heads for downstream tasks, including functionality classification and malware detection. Evaluations on a diverse dataset of 155,238 unpacked Windows executables demonstrate that MalwarePT outperforms state-of-the-art models like Malconv2 and Ember-based classifiers in functionality identification, achieving higher precision, recall, and F1-scores. In malware detection, MalwarePT matches the performance of leading ML-based detectors while exhibiting superior robustness against various adversarial attacks, including novel code-based evasion techniques and temporal shifts. The model maintains effectiveness even in the presence of packing, a common malware obfuscation method. An ablation study confirms the advantage of MalwarePT’s multi-head attention mechanism over alternative neural network architectures. Security discussions address potential evasion strategies and propose solutions to enhance MalwarePT’s resilience further. Overall, MalwarePT advances the field of malware analysis by providing a more generalizable and adversarially robust foundation model, reducing reliance on handcrafted features, and offering a promising direction for future research in resilient malware detection systems.


tags: [Malware Analysis, AI, Neural Networks, Program Analysis]

# Display this page in the Featured widget?
featured: false
---


<!-- {{% callout note %}}
Click the _Cite_ button above to demo the feature to enable visitors to import publication metadata into their reference management software.
{{% /callout %}}

{{% callout note %}}
Create your slides in Markdown - click the _Slides_ button to check out the example.
{{% /callout %}}

Add the publication's **full text** or **supplementary notes** here. You can use rich formatting such as including [code, math, and images](https://docs.hugoblox.com/content/writing-markdown-latex/). -->
